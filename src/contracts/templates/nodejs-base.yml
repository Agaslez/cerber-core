# Example: Node.js CI Contract
# Base contract for Node.js projects

contractVersion: 1
name: nodejs-ci-base
version: 1.0.0

metadata:
  description: Base contract for Node.js CI workflows
  author: Cerber Core Team
  repository: https://github.com/Agaslez/cerber-core
  tags:
    - nodejs
    - ci
    - base

defaults:
  permissionsPolicy:
    maxLevel: read
    allowedScopes:
      - contents
      - pull-requests
  
  actionPinning: required
  secretsPolicy: no-hardcoded
  
  nodeVersion:
    required: true
    minVersion: "18.0.0"

rules:
  security/no-hardcoded-secrets: error
  security/require-action-pinning: error
  security/limit-permissions: error
  security/checkout-persist-credentials: warning
  best-practices/cache-dependencies: warning
  best-practices/setup-node-version: error
  performance/avoid-unnecessary-checkout: warning

requiredActions:
  - action: actions/checkout@v4
    minVersion: "4"
  - action: actions/setup-node@v4
    minVersion: "4"

requiredSteps:
  - name: Install dependencies
    command: npm ci
  - name: Run tests
    command: npm test

allowedTriggers:
  - push
  - pull_request
  - workflow_dispatch
