# React CI Contract
# Contract for React applications with build and test requirements
contractVersion: 1
name: react-ci-contract
version: 1.0.0

metadata:
  description: 'Contract for React CI/CD workflows with build optimization and testing'
  author: 'Cerber Core'
  tags:
    - react
    - npm
    - ci
    - frontend

# Extend nodejs-base contract since React requires Node.js
extends: '@cerber-core/contracts/nodejs-base'

defaults:
  permissionsPolicy:
    maxLevel: read
    allowedScopes:
      - contents
      - pull-requests
  actionPinning: required
  secretsPolicy: no-hardcoded
  nodeVersion:
    required: true
    minVersion: '18.0.0'

rules:
  # Security rules
  security/no-hardcoded-secrets: error
  security/require-action-pinning: error
  security/limit-permissions: error
  security/no-wildcard-triggers: warning
  security/checkout-persist-credentials: warning
  
  # Best practices
  best-practices/cache-dependencies: warning
  best-practices/setup-node-version: error
  best-practices/parallelize-matrix: warning
  best-practices/optimize-build: warning
  
  # Performance
  performance/avoid-unnecessary-checkout: warning
  performance/use-composite-actions: info

requiredActions:
  - action: actions/checkout@v4
    minVersion: '4'
  - action: actions/setup-node@v4
    minVersion: '4'

requiredSteps:
  - name: install
    command: npm ci
    description: Install dependencies with clean install
  - name: build
    command: npm run build
    description: Build React application
  - name: test
    command: npm test
    description: Run test suite

allowedTriggers:
  - push
  - pull_request
  - workflow_dispatch

recommendedPractices:
  - Use dependency caching for faster installs
  - Test on multiple Node.js versions (18.x, 20.x)
  - Upload build artifacts for deployment
  - Run tests with coverage reporting
  - Optimize build output size
