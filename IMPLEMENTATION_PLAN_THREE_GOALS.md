# ðŸŽ¯ IMPLEMENTATION PLAN - Trzy Cele (14.01.2026)

## CEL 1: FAST vs HEAVY CI Gates
**Status**: Planning  
**Deadline**: Today  
**Blocker**: Workflow redesign required

### Zmany Wymagane:
1. Nowy workflow: `.github/workflows/cerber-pr-fast.yml` (required checks)
2. Rename: `.github/workflows/cerber-verification.yml` â†’ `cerber-main-heavy.yml`
3. Branch protection update (only FAST jobs)
4. Job pruning: UsunÄ…Ä‡ E2E/pack/signals z PR workflow

---

## CEL 2: One Truth (.cerber/contract.yml)
**Status**: Planning  
**Deadline**: This week  
**Blocker**: Generator + drift checker required

### Zmany Wymagane:
1. Create: `.cerber/contract.yml` (YAML source of truth)
2. Create: `src/cli/generator.ts` (CERBER.md + workflows + CODEOWNERS generator)
3. Create: `src/cli/drift-checker.ts` (Detect drift from contract)
4. Add: `npm run cerber:generate` + `npm run cerber:drift`
5. Add: Guardian rule to block manual edits of auto-generated files
6. Add: Header "AUTO-GENERATED BY CERBER â€” DO NOT EDIT" to generated files

---

## CEL 3: Test Organization  
**Status**: Planning  
**Deadline**: This week  
**Blocker**: Jest config + test tagging

### Zmany Wymagane:
1. Add jest test tags: `@fast`, `@integration`, `@e2e`, `@signals`
2. Update `package.json` scripts: `test:fast`, `test:integration`, etc.
3. Update `jest.config.cjs` to support tag-based filtering
4. Stabilize flaky tests (retry + higher timeouts in HEAVY only)

---

## EXECUTION ORDER

### Phase 1: CI Structure (CEL 1)
- [ ] Create `cerber-pr-fast.yml` (required + minimal)
- [ ] Create `cerber-main-heavy.yml` (all comprehensive tests)
- [ ] Update branch protection (only fast checks)
- [ ] Verify: PR has green checks (no heavy blocker)

### Phase 2: One Truth Architecture (CEL 2)
- [ ] Create `.cerber/contract.yml` (YAML source)
- [ ] Create generator (cerber:generate)
- [ ] Create drift checker (cerber:drift)
- [ ] Add auto-generation headers
- [ ] Update Guardian to protect generated files
- [ ] Add to CI: cerber:drift as gate (FAST tier)

### Phase 3: Test Organization (CEL 3)
- [ ] Tag all tests with @fast/@integration/@e2e/@signals
- [ ] Add npm run test:* scripts
- [ ] Update jest.config.cjs
- [ ] Map CI workflows to test scripts
- [ ] Stabilize flaky tests

---

## READY FOR SUBAGENT?

**YES** - This is complex enough to warrant parallel work.

I will:
1. Create detailed spec for subagent
2. Provide template files
3. Verify outputs
4. Integration testing

---

**Proceed?** (y/n)

